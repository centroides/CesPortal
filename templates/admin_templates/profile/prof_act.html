<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <title>Centroid Engineering Solutions</title>
    <link rel="icon" type="image/jpeg" href="static/ces_logo.png">
    <link rel="stylesheet" href="../static/res_style.css">
    <link rel="stylesheet"
        href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <!-- <script src="https://kit.fontawesome.com/f8e1a90484.js" crossorigin="anonymous"></script> -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />

</head>

<body>

    <input type="checkbox" id="menu-toggle">

    <div class="sidebar">

        <div class="side-header">
            <h3>C<span>entroid</span></h3>
        </div>

        <div class="side-content">

            <div class="profile">
                <div class="profile-img bg-img" style="background-image: url(../static/1.png)"></div>
                <h4>{{user['name']}}</h4>
                <small>{{department_code}}</small>
            </div>

            <div class="side-menu">
                <ul>

                    {% if department_code == 1000 %}
                    <li>
                        <a href="/admin">
                            <span class="fa-solid fa-user-tie"></span>
                            <small>Admin</small>
                        </a>
                    </li>
                    {% endif %}

                    {% if user_access['Accounts'] == 'On' %}
                    <li>
                        <a href="/accounts">
                            <span class="fa-solid fa-file-invoice-dollar"></span>
                            <small>Accounts</small>
                        </a>
                    </li>
                    {% endif %}
                    {% if user_access['toggleEnquiry'] == 'On' %}
                    <li>
                        <a href="/admin_enquiry">
                            <span class="fa-solid fa-handshake"></span>
                            <small>Leads</small>
                        </a>
                    </li>
                    {% endif %}
                    {% if user_access['toggleHR'] == 'On' %}
                    <li>
                        <a href="/hr">
                            <span class="fa-solid fa-user-plus"></span>
                            <small>HR</small>
                        </a>
                    </li>
                    {% endif %}
                    {% if user_access['togglePlanner'] == 'On' %}
                    <li>
                        <a href="/planner">
                            <span class="fa-solid fa-calendar-check"></span>
                            <small>Planner</small>
                        </a>
                    </li>
                    {% endif %}
                    {% if user_access['toggleProfile'] == 'On' %}
                    <li>
                        <a href="/profile" class="active">
                            <span class="fa-solid fa-user"></span>
                            <small>Profile</small>
                        </a>
                    </li>
                    {% endif %}
                    {% if user_access['toggleProjects'] == 'On' %}
                    <li>
                        <a href="/projects">
                            <span class="fa-solid fa-chart-simple"></span>
                            <small>Project</small>
                        </a>
                    </li>
                    {% endif %}
                    {% if user_access['togglePurchase'] == 'On' %}
                    <li>
                        <a href="/purchase">
                            <span class="fa-solid fa-cart-shopping"></span>
                            <small>Purchase</small>
                        </a>
                    </li>
                    {% endif %}

                    {% if user_access['toggleResources'] == 'On' %}
                    <li>
                        <a href="/resources">
                            <span class="fa-solid fa-recycle"></span>
                            <small>Resources</small>
                        </a>
                    </li>
                    {% endif %}

                    {% if department_code == 1000 %}
                    <li>
                        <a href="/settings">
                            <span class="fa-solid fa-gears"></span>
                            <small>Settings</small>
                        </a>
                    </li>
                    {% endif %}

                    <li>
                        <a href="{{ url_for('logout') }}">
                            <span class="fa-solid fa-right-from-bracket"></span>
                            <small>Log Out</small>
                        </a>
                    </li>
                </ul>
            </div>



        </div>

    </div>

    <div class="main-content">

        <div class="page-content" style="background-color: white;">

            <div class="page-header" style="background-color: white;">

                <nav class="navbar1">

                    <ul id="menuList1" class="navitems1">

                        {% if user_access['toggleAccountHub'] == 'On' %}
                        <li class="active">
                            <a href="{{ url_for('prof_act') }}" class="link">
                                <i class="fa-solid fa-user" style="margin-right: 5px;"></i> Account Info
                            </a>
                        </li>
                        {% endif %}

                        {% if user_access['toggle_prof_TimeSheet'] == 'On' %}
                        <li>
                            <a href="{{ url_for('prof_time') }}" class="link">
                                <i class="fas fa-clock" style="margin-right: 5px;"></i> Time Sheet
                            </a>
                        </li>
                        {% endif %}

                        {% if user_access['toggleProfPurchaseRequest'] == 'On' %}
                        <li>
                            <a href="{{ url_for('prof_pr') }}" class="link">
                                <i class="fa-solid fa-cart-shopping" style="margin-right: 5px;"></i> Purchase Request
                            </a>
                        </li>
                        {% endif %}
                        {% if user_access['toggleProfPurchaseOrder'] == 'On' %}
                        <li>
                            <a href="{{ url_for('prof_po') }}" class="link">
                                <i class="fa-solid fa-file-invoice" style="margin-right: 5px;"></i> Purchase Order
                            </a>
                        </li>
                        {% endif %}
                        {% if user_access['toggleProjectRequest'] == 'On' %}
                        <li>
                            <a href="{{ url_for('prof_prj') }}" class="link">
                                <i class="fa-solid fa-project-diagram" style="margin-right: 5px;"></i> Project Request
                            </a>
                        </li>
                        {% endif %}
                        {% if user_access['togglePaymentRequest'] == 'On' %}
                        <li>
                            <a href="{{ url_for('prof_pay') }}" class="link">
                                <i class="fa-solid fa-hand-holding-dollar" style="margin-right: 5px;"></i> Payment
                                Request
                            </a>
                        </li>
                        {% endif %}
                        {% if user_access['toggle_prof_claims'] == 'On' %}
                        <li>
                            <a href="{{ url_for('prof_claim') }}" class="link">
                                <i class="fa-solid fa-file-alt" style="margin-right: 5px;"></i> Claims
                            </a>
                        </li>
                        {% endif %}
                        {% if user_access['toggleDeliveryOrders'] == 'On' %}
                        <li>
                            <a href="{{ url_for('prof_do') }}" class="link">
                                <i class="fa-solid fa-box" style="margin-right: 5px;"></i> Delivery Order
                            </a>
                        </li>
                        {% endif %}

                        {% if user_access['toggleprofSuppliers'] == 'On' %}
                        <li>
                            <a href="{{ url_for('prof_supplier') }}" class="link">
                                <i class="fa-solid fa-truck" style="margin-right: 5px;"></i> Suppliers
                            </a>
                        </li>
                        {% endif %}


                    </ul>

                    <div class="menu-icon">
                        <i class="fa-solid fa-bars" onclick="toggleMenu()"></i>
                    </div>

                    <script>
                        let menuList1 = document.getElementById("menuList1");
                        menuList1.style.maxHeight = "0px";

                        function toggleMenu1() {
                            if (menuList1.style.maxHeight == "0px") {
                                menuList1.style.maxHeight = "300px";
                            } else {
                                menuList1.style.maxHeight = "0px";
                            }
                        }
                    </script>

                </nav>

                <div class="line"></div>

            </div>

            <div class="search_container">

                <div class="timenav">
                    <link rel="stylesheet"
                        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

                    <ul id="menuList1" class="timebar">


                        {% if user_access['togglePersonalDetails'] == 'On' %}
                        <li>
                            <input type="radio" id="Personal_DetailsRadio" name="sectionRadio"
                                onclick="showSection('Personal_Details'); toggleContainer('Personal_Details')"
                                style="display: none;">
                            <label for="Personal_DetailsRadio" class="link1">
                                <i class="fa-solid fa-user-circle" style="margin-right: 5px;"></i> Personal Details
                            </label>
                        </li>
                        {% endif %}

                        {% if user_access['toggleprof_Leaves'] == 'On' %}
                        <li>
                            <input type="radio" id="LeavesRadio" name="sectionRadio"
                                onclick="showSection('Leaves'); toggleContainer('Leaves')" style="display: none;">
                            <label for="LeavesRadio" class="link1"><i class="fas fa-house-user"
                                    style="margin-right: 5px;"></i>Leaves</label>

                        </li>
                        {% endif %}
                        {% if user_access['toggle_prof_Courses'] == 'On' %}
                        <li>
                            <input type="radio" id="CoursesRadio" name="sectionRadio"
                                onclick="showSection('Courses'); toggleContainer('Courses')" style="display: none;">
                            <label for="CoursesRadio" class="link1"><i class="fa-solid fa-layer-group"
                                    style="margin-right: 5px;"></i> Courses</label>
                        </li>
                        {% endif %}
                        {% if user_access['toggle_prof_Payslip'] == 'On' %}
                        <li>
                            <input type="radio" id="Pay_slipRadio" name="sectionRadio"
                                onclick="showSection('Pay_slip'); toggleContainer('Pay_slip')" style="display: none;">
                            <label for="Pay_slipRadio" class="link1"><i class="fa-sharp fa-solid fa-comments-dollar"
                                    style="margin-right: 5px;"></i>Pay Slip</label>
                        </li>
                        {% endif %}
                        {% if user_access['toggle_prof_Assets'] == 'On' %}
                        <li>
                            <input type="radio" id="AssetsRadio" name="sectionRadio"
                                onclick="showSection('Assets'); toggleContainer('Assets')" style="display: none;">
                            <label for="AssetsRadio" class="link1"><i class="fa-sharp fa-solid fa-computer"
                                    style="margin-right: 5px;"></i>Assets</label>
                        </li>
                        {% endif %}

                    </ul>

                    <div class="menu-icon1">
                        <i class="fa-solid fa-bars" onclick="toggleMenu1()"></i>
                    </div>
                </div>

                <style>
                    .search_container {

                        width: 100%;
                        padding: 10px;
                    }


                    #projectTable {
                        width: 100%;
                        border-collapse: separate;
                        border-spacing: 0;
                        border-radius: 10px;
                    }
                </style>

            </div>

            <div class="Personal_Details" id="Personal_Details">

                <div class="container">

                    <div class="invoice-header">
                        <div class="invoice-row">
                            <p><strong>Employee Name</strong></p> <span>{{ emp_data['Full_Employee_ID'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Username</strong></p> <span>{{ emp_data['display_Name'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Designation</strong></p> <span>{{ emp_data['Designation'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Expense Code</strong></p> <span>{{ emp_data['Expense_Code'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Email ID</strong></p> <span>{{ emp_data['Email_Id'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Race</strong></p> <span>{{ emp_data['Race'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Sector</strong></p> <span>{{ emp_data['Sector'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Date Joined</strong></p> <span>{{ emp_data['Date_Joined'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Date Left</strong></p> <span>{{ emp_data['Date_Left'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Employee Status</strong></p> <span>{{ emp_data['Employee_Status'] }}</span>
                        </div>
                    </div>

                    <div class="invoice-header">
                        <div class="invoice-row">
                            <p><strong>Nationality</strong></p> <span>{{ emp_data['Nationality'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Pass Type</strong></p> <span>{{ emp_data['Pass_Type'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>NRIC</strong></p> <span>{{ emp_data['NRIC'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>FIN</strong></p> <span>{{ emp_data['FIN'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>WP</strong></p> <span>{{ emp_data['WP'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Passport No</strong></p> <span>{{ emp_data['Passport_No'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Passport Expiry Date</strong></p> <span>{{ emp_data['Passport_Exp_Date']
                                }}</span>
                        </div>
                    </div>

                    <div class="invoice-header">
                        <div class="invoice-row">
                            <p><strong>Date of Birth</strong></p> <span>{{ emp_data['DOB'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Phone No</strong></p> <span>{{ emp_data['Phone_No'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Personal Mail</strong></p> <span>{{ emp_data['Personal_Mail'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Address</strong></p> <span>{{ emp_data['Address'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Emerg. Contact</strong></p> <span>{{ emp_data['Emergency_Contact'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Emerg. Contact Add</strong></p> <span>{{
                                emp_data['Emergency_Contact_Address'] }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Relation to Employee</strong></p> <span>{{ emp_data['Relation_to_Employee']
                                }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Emerg. Contact No</strong></p> <span>{{ emp_data['Emergency_Contact_No']
                                }}</span>
                        </div>
                        <div class="invoice-row">
                            <p><strong>Annual Leave</strong></p> <span>{{ emp_data['Annual_Leave'] }}</span>
                        </div>
                    </div>

                </div>

                <style>
                    .table-responsive1 {
                        width: 100%;
                        overflow: auto;
                        max-height: 450px;
                        border-radius: 10px;
                        border: 1px solid #ddd;
                    }

                    .table-responsive2 {
                        width: 100%;
                        overflow: auto;
                        max-height: 120px;
                        border-radius: 10px;
                        border: 1px solid #ddd;
                    }

                    .table-main {
                        width: 100%;
                        border-collapse: collapse;
                    }

                    .table-main thead {
                        position: sticky;
                        top: 0;
                        background: white;
                        z-index: 10;
                    }



                    .container {
                        background-color: white;
                        padding: 10px;
                        border-radius: 10px;
                        display: flex;
                        flex: 1;
                        gap: 20px;
                        border: 2px solid #ccc;
                        /* Adding border with 2px width and light gray color */

                    }



                    .invoice-header {
                        flex: 1;
                    }

                    .invoice-row {
                        display: grid;
                        grid-template-columns: 180px auto;
                        /* First column for labels, second for values */
                        gap: 10px;
                        align-items: center;
                        padding: 5px 0;
                    }

                    .invoice-row p {
                        margin: 0;
                        font-weight: bold;
                        text-align: left;
                    }

                    .invoice-row span {
                        text-align: left;
                    }


                    .invice_header {
                        width: 100%;
                        padding: 10px;

                    }

                    .button-container1 {
                        display: flex;
                        flex: 1;
                        justify-content: space-between;
                        align-items: center;
                        width: 100%;
                        margin-top: 10px;
                        gap: 10px;
                    }

                    .button-container2 {
                        display: flex;
                        flex: 1;
                        justify-content: center;
                        align-items: center;
                        width: 100%;
                        margin-top: 10px;
                        gap: 10px;
                    }


                    .title-box {
                        display: flex;
                        padding: 5px;
                        background-color: white;
                        border-radius: 8px;
                        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                        margin-bottom: 10px;
                        justify-content: space-between;

                    }

                    .title-item {
                        display: flex;
                        align-items: center;

                        /* Align title and value on the same row */
                    }

                    .title-item span {
                        font-size: 18px;
                        font-weight: bold;
                        color: #004b5d;
                    }


                    @keyframes open {
                        from {
                            width: 20px;
                            /* Start with 0 width */
                        }

                        to {
                            width: 573px;
                            /* Animate to 473px width */
                        }
                    }

                    /* Responsive styling for smaller screens */
                    @media (max-width: 768px) {
                        .title-box {
                            flex-direction: column;
                            /* Stack items vertically on smaller screens */
                            align-items: flex-start;
                        }

                        .title-item {
                            margin-bottom: 15px;
                            /* Space between stacked items */
                        }
                    }
                </style>

            </div>

            <div class="Leaves" id="Leaves" style="display: none;">

                <div class="mainbox">

                    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

                    <div class="column first-column">

                        <form id="leaveForm">

                            <div class="row">

                                <div class="col-6">
                                    <label>Select Employee</label>
                                    <select class="form-select" id="Received_by" name="Received_by" required
                                        onchange="fectch_data()">
                                        <option value="" disabled selected>Select Employee</option>
                                        {% for username in usernames %}
                                        <option value="{{ username }}">{{ username }}</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="col-6">
                                    <label for="leave_type">Leave Type</label>
                                    <select class="form-select" id="leave_type" name="leave_type" required>
                                        <option value="" disabled selected>Select Leave Type</option>
                                        <option value="Medical">Medical</option>
                                        <option value="Annual">Annual</option>
                                        <option value="Maternity">Maternity</option>
                                        <option value="Paternity">Paternity</option>
                                        <option value="Unpaid">Unpaid</option>
                                    </select>
                                </div>

                                <div class="col-6">
                                    <label for="start_date">Start Date</label>
                                    <input type="date" id="start_date" name="start_date" required
                                        max="{{ today_date }}">
                                </div>

                                <div class="col-6">
                                    <label for="end_date">End Date</label>
                                    <input type="date" id="end_date" name="end_date" required max="{{ today_date }}">
                                </div>

                                <div class="col-6">
                                    <label for="number_of_days">Number of Days</label>
                                    <input type="number" id="number_of_days" name="number_of_days" required readonly>
                                </div>

                                <div class="button-container">
                                    <input type="hidden" id="action" name="action" value="apply_leave">
                                    <button type="button" id="submitBtn" class="custom-btn btn-2">Apply
                                        Leave</button>

                                </div>

                                <div id="responseMessage"></div>

                            </div>

                        </form>

                        <script>

                            document.getElementById('submitBtn').addEventListener('click', function () {
                                const form = document.getElementById('leaveForm');
                                const formData = new FormData(form);

                                const leaveType = document.getElementById('leave_type').value;
                                const numberOfDays = parseFloat(document.getElementById('number_of_days').value);

                                // Validate leaveType is selected
                                if (!leaveType) {
                                    alert('Please select a leave type.');
                                    return;
                                }

                                // Skip check for unpaid leave
                                if (leaveType !== 'Unpaid') {
                                    const leaveTableBody = document.getElementById('leaveTableBody');
                                    let sufficientBalance = true;

                                    for (let row of leaveTableBody.rows) {
                                        const type = row.cells[0].textContent.trim();
                                        const balance = parseFloat(row.cells[3].textContent.trim());

                                        if (type === leaveType) {
                                            if (numberOfDays > balance) {
                                                alert('Number of days exceeds earned leave balance. You may need to go with unpaid leave.');
                                                sufficientBalance = false;
                                            }
                                            break;
                                        }
                                    }

                                    if (!sufficientBalance) return;  // Stop form submission
                                }

                                // Proceed with form submission if validation passes
                                fetch('/prof_act', {
                                    method: 'POST',
                                    body: formData,
                                })
                                    .then(response => {
                                        if (!response.ok) throw new Error('Network response was not ok');
                                        return response.json();
                                    })
                                    .then(data => {
                                        const responseMessage = document.getElementById('responseMessage');
                                        if (data.success) {
                                            responseMessage.innerHTML = `<div class="alert alert-success">${data.message}</div>`;
                                            form.reset();
                                        } else {
                                            responseMessage.innerHTML = `<div class="alert alert-danger">${data.message}</div>`;
                                        }
                                    })
                                    .catch(error => {
                                        console.error('Error during AJAX request:', error);
                                        const responseMessage = document.getElementById('responseMessage');
                                        responseMessage.innerHTML = `<div class="alert alert-danger">An error occurred while submitting the form.</div>`;
                                    });
                            });


                        </script>

                        <div class="row">

                            <div class="chart-container">
                                <canvas id="leaveTypePieChart" width="400" height="400"></canvas>
                            </div>
                        </div>

                    </div>

                    <script>
                        // Calculate days logic
                        document.getElementById('start_date').addEventListener('change', calculateDays);
                        document.getElementById('end_date').addEventListener('change', calculateDays);

                        function calculateDays() {
                            const startDate = document.getElementById('start_date').value;
                            const endDate = document.getElementById('end_date').value;

                            if (startDate && endDate) {
                                fetch(`/calculate_days?start_date=${startDate}&end_date=${endDate}`)
                                    .then(response => response.json())
                                    .then(data => {
                                        document.getElementById('number_of_days').value = data.days;
                                    });
                            }
                        }

                    </script>

                    <div class="column first-column">

                        <div class="table-responsive2">
                            <table class="content-table-leave"
                                style="width: 100%; table-layout: fixed; border-collapse: collapse;">
                                <thead>
                                    <tr>
                                        <th style="width: 25%;">Leave Type</th>
                                        <th style="width: 25%;">Earned Leave</th>
                                        <th style="width: 25%;">Days Used</th>
                                        <th style="width: 25%;">Balance</th>
                                    </tr>
                                </thead>
                                <tbody id="leaveTableBody">

                                </tbody>
                            </table>
                        </div>



                        <div class="row">

                            <div class="chart-container">
                                <canvas id="monthlyLeaveChart" width="450" height="350"></canvas>
                            </div>

                        </div>

                    </div>

                    <div class="column third-column">

                        <div class="table-responsive2">

                            <table class="content-table-leave">
                                <thead>
                                    <tr>
                                        <th style="width: 3%;">Type</th>
                                        <th style="width: 3%;">StartDate</th>
                                        <th style="width: 3%;">EndDate</th>
                                        <th style="width: 2%;">Days</th>
                                        <th style="width: 3%;">Status</th>
                                        <th style="width: 12%;">ApprovedBy</th>
                                        <!-- <th style="width: 8%;">Approved Date</th> -->
                                    </tr>
                                </thead>
                                <tbody id="approvedLeaveTableBody">
                                    <!-- Approved leave data will be dynamically inserted here -->
                                </tbody>
                            </table>

                        </div>


                        <div class="row">
                            <div class="chart-container">
                                <canvas id="leaveChart" width="450" height="350"></canvas>
                            </div>
                        </div>

                    </div>

                </div>

            </div>

            <div class="Courses" id="Courses" style="display: none;">

                <div class="sub-container" style=" margin-left: 370PX; width: 200%;">

                    <table class="content-table">

                        <thead>
                            <tr>
                                <th>S/N</th>
                                <!-- <th>Name</th> -->
                                <th>Course</th>
                                <th>Attained Date</th>
                                <th>Expiry Date</th>
                                <th>Days Left</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% if courses %}
                            {% for course in courses %}
                            <tr class="active-row">
                                <td>{{ loop.index }}</td>
                                <!-- <td>{{ course['Name'] }}</td> -->
                                <td>{{ course['Course_Name'] }}</td>
                                <td class="start-time">{{ course['Date_Attained'] }}</td>
                                <td class="start-time">{{ course['Expiry_Date'] }}</td>
                                <td>{{ course['Days_Left'] }}</td>
                            </tr>
                            {% endfor %}

                            {% else %}

                            <td colspan="5" class="text-center"
                                style="text-align: center; font-size: larger; color: #dc3545;">No courses found.
                            </td>

                            {% endif %}
                        </tbody>
                    </table>

                </div>

            </div>

            <div class="Pay_slip" id="Pay_slip" style="display: none;">

                <style>
                    .salrary {
                        width: 50%;
                        margin: 0 auto;
                        /* Centers the block element horizontally */
                        text-align: center;
                        /* (Optional) Centers the text inside the div */
                    }


                    .header {
                        text-align: center;
                        font-size: 24px;
                        color: red;
                        font-weight: bold;
                    }

                    .company-info {
                        display: flex;
                        border: 1px solid #000;
                    }

                    .logo,
                    .company-details {
                        flex: 1;
                        text-align: center;
                        padding: 10px;
                    }

                    .company-details {
                        background-color: green;
                        color: white;
                        font-weight: bold;
                    }

                    .payslip-period {
                        border: 1px solid #000;
                        text-align: center;
                        padding: 5px;
                        font-weight: bold;
                    }

                    .info-table,
                    .payment-table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-top: 10px;
                    }

                    .info-table td {
                        border: 1px solid #000;
                        padding: 5px;
                    }

                    .payment-table th,
                    .payment-table td {
                        border: 1px solid #000;
                        padding: 5px;
                        text-align: right;
                    }

                    .payment-table th {
                        background-color: #eee;
                    }

                    .total {
                        font-weight: bold;
                    }

                    .footer {
                        font-weight: bold;
                        margin-top: 10px;
                    }

                    .highlight {
                        color: green;
                        font-size: 14px;
                        margin-top: 10px;
                    }
                </style>

                <div class="salrary">


                    <div class="header">Payslip</div>

                    <div class="company-info">
                        <div class="logo"><strong>Company Logo</strong></div>
                        <div class="company-details">
                            Centroid Engineering Solutions<br>

                        </div>
                    </div>

                    <div class="payslip-period">Payslip For the Month of April 2025</div>

                    <table class="info-table">
                        <tr>
                            <td><strong>Employee Name:</strong> Rajesh Gowda</td>
                            <td><strong>Paid Days:</strong> 30</td>
                        </tr>
                        <tr>
                            <td><strong>Gender:</strong> Male</td>
                            <td><strong>LOP Days:</strong> 0</td>
                        </tr>
                    </table>

                    <table class="payment-table">
                        <tr>
                            <th colspan="2">Earnings</th>
                            <th colspan="2">Deductions</th>
                        </tr>
                        <tr>
                            <td>Basic</td>
                            <td>10,000</td>
                            <td>Salary Advance</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td>OT Hours</td>
                            <td>50</td>
                            <td>Other Deductions</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td>OT Rate</td>
                            <td>75</td>
                            <td colspan="2"></td>
                        </tr>
                        <tr>
                            <td>OT Payment</td>
                            <td>3750</td>
                            <td colspan="2"></td>
                        </tr>
                        <tr class="total">
                            <td>Total Payment</td>
                            <td>13,750</td>
                            <td>Total Deductions</td>
                            <td>1,000</td>
                        </tr>
                    </table>

                    <div class="footer">Net Pay: <strong>12,750</strong></div>
                    <div class="highlight">Â© Centroid</div>

                </div>

            </div>

            <div class="Assets" id="Assets" style="display: none;">

                <div class="sub-container" style=" margin-left: 370PX; width: 200%;">

                    <table class="content-table">
                        <thead>
                            <tr>
                                <th scope="col">S/N</th>
                                <th scope="col">Product</th>
                                <th scope="col">Date Issued</th>
                                <th scope="col">Model</th>
                                <th scope="col">Code</th>
                                <th scope="col">Date Returned</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if assets %}
                            {% for asset in assets %}
                            <tr>
                                <td>{{ loop.index }}</td>
                                <td>{{ asset['Asset_Type'] }}</td>
                                <td>{{ asset['Date_Issued'] }}</td>
                                <td>{{ asset['Model'] }}</td>
                                <td>{{ asset['Serial_Number'] }}</td>
                                <td>{{ asset['Date_Returned'] }}</td>
                            </tr>
                            {% endfor %}
                            {% else %}
                            <td colspan="6" class="text-center"
                                style="text-align: center; font-size: larger; color: #dc3545;">No Assets found.
                            </td>
                            {% endif %}
                        </tbody>
                    </table>



                </div>
            </div>

        </div>

    </div>

    <style>
        /* Container for graphs */
        .graphs {
            display: flex;
            flex-direction: row;
            /* Ensure charts are in a row */
            gap: 10px;
            /* Space between charts */
        }

        /* Individual chart styling */
        .chart1 {
            background-color: white;
            border-radius: 10px;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;

            width: 650px;
            /* Set width for the chart container */
            height: 350px;
            /* Set height for the chart container */
        }

        .chart12 {

            background-color: white;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;

            width: 450px;
            /* Set width for the chart container */
            height: 350px;
            /* Set height for the chart container */
        }

        #doughnut-chart {
            width: 100%;
            height: 350px;
            /* Ensure height is enough for the chart */
        }

        #doughnut-chart1 {
            width: 100%;
            height: 350px;
            /* Ensure height is enough for the chart */
        }

        /* Alerts container */
        .alerts {
            display: flex;
            flex-direction: column;
            /* Ensure alerts are in a column */
            gap: 10px;
            /* Space between alerts */
            max-height: 350px;
            /* Set a maximum height for the container */
            overflow-y: auto;
            /* Enable vertical scrolling */
            border-radius: 5px;
            /* Optional: Rounded corners */
            width: 100%;
            /* Take full width of the parent container */
            box-sizing: border-box;
            /* Ensure padding is included in the width */
        }

        /* Individual alert styling */
    </style>

    <script>

        let leaveChartInstance, monthlyLeaveChartInstance, leaveTypePieChartInstance;

        function plotChart(chartData) {
            console.log("plotChart called with data:", chartData);
            const ctx = document.getElementById('leaveChart').getContext('2d');
            if (leaveChartInstance) leaveChartInstance.destroy(); // Clear existing chart
            leaveChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: chartData.leave_types || [],
                    datasets: [
                        {
                            label: 'Eligible Days',
                            data: chartData.eligible_days || [],
                            backgroundColor: 'rgba(75, 192, 192, 0.5)',
                        },
                        {
                            label: 'Days Used',
                            data: chartData.days_used || [],
                            backgroundColor: 'rgba(255, 99, 132, 0.5)',
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Employee Leave Usage'
                        },
                        datalabels: {
                            anchor: 'center',
                            align: 'center',
                            formatter: (value) => value,
                            color: '#444',
                            font: {
                                weight: 'bold'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        function plotMonthlyChart(chartData) {
            console.log("plotMonthlyChart called with data:", chartData);
            const ctx = document.getElementById('monthlyLeaveChart').getContext('2d');
            if (monthlyLeaveChartInstance) monthlyLeaveChartInstance.destroy();

            const shadowPlugin = {
                id: 'shadowPlugin',
                beforeDatasetDraw: (chart, args, options) => {
                    const { ctx, chartArea: { top, bottom } } = chart;
                    const datasetMeta = chart.getDatasetMeta(args.index);
                    const bars = datasetMeta.data;

                    // Apply shadow only to bar elements
                    ctx.save();
                    ctx.shadowColor = 'rgba(0, 0, 0, 0.4)'; // Shadow color
                    ctx.shadowBlur = 10; // Shadow blur level
                    ctx.shadowOffsetX = 5; // Horizontal shadow offset
                    ctx.shadowOffsetY = 5; // Vertical shadow offset

                    bars.forEach(bar => bar.draw(ctx)); // Apply shadow to each bar
                    ctx.restore();
                }
            };

            monthlyLeaveChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: chartData.months || [],
                    datasets: [
                        {
                            label: 'Leaves per Month',
                            data: chartData.monthly_leave_counts || [],
                            backgroundColor: [
                                '#003f5c', '#58508d', '#bc5090', '#ff6361', '#ffa600',
                                '#ff7c43', '#f95d6a', '#d45087', '#a05195', '#665191',
                                '#2f4b7c', '#c80064'
                            ],
                            borderColor: [
                                'rgba(33, 37, 41, 1)', 'rgba(0, 51, 102, 1)', 'rgba(0, 102, 102, 1)',
                                'rgba(51, 51, 153, 1)', 'rgba(102, 51, 153, 1)', 'rgba(0, 51, 153, 1)',
                                'rgba(102, 0, 51, 1)', 'rgba(51, 51, 102, 1)', 'rgba(77, 0, 77, 1)',
                                'rgba(25, 25, 112, 1)', 'rgba(47, 79, 79, 1)', 'rgba(0, 51, 51, 1)'
                            ],
                            borderWidth: 1,
                            borderRadius: 2, // Rounded corners
                            hoverBackgroundColor: '#fff' // Highlight on hover
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Monthly Leave Count'
                        },
                        datalabels: {
                            anchor: 'center',
                            align: 'center',
                            formatter: (value) => value,
                            color: '#fff',
                            font: {
                                weight: 'bold'
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false // Hide grid lines on x-axis for a cleaner look
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)' // Light gray grid lines for y-axis
                            }
                        }
                    },
                    animation: {
                        duration: 1000, // Smooth animation duration
                        easing: 'easeOutBounce' // Bounce effect on load
                    }
                },
                plugins: [ChartDataLabels, shadowPlugin] // Combine plugins in a single array
            });
        }

        function plotPieChart(chartData) {
            console.log("plotPieChart called with data:", chartData);
            const ctx = document.getElementById('leaveTypePieChart').getContext('2d');
            if (leaveTypePieChartInstance) leaveTypePieChartInstance.destroy();

            leaveTypePieChartInstance = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: chartData.leave_types || [],
                    datasets: [
                        {
                            label: 'Leave Type Count',
                            data: chartData.days_used || [],  // Use `days_used` instead of `leave_counts`
                            backgroundColor: [
                                '#0095A8',  // Darker color for 3D effect
                                '#112E51',
                                '#FF7043',
                                '#78909C',
                                '#384860'
                            ],
                            hoverBackgroundColor: [
                                'rgba(265, 99, 132, 0.8)',  // Darker color for 3D effect
                                'rgba(64, 162, 235, 0.8)',
                                'rgba(265, 206, 86, 0.8)',
                                'rgba(65, 192, 192, 0.8)',
                                'rgba(163, 102, 255, 0.8)'
                            ],
                            borderWidth: 1,
                            borderColor: '#fff',
                            hoverOffset: 12 // Creates a more pronounced hover effect for 3D feel
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Leave Type Distribution',
                            color: '#444'
                        },
                        datalabels: {
                            formatter: (value) => value,
                            color: '#fff',
                            font: {
                                weight: 'bold'
                            }
                        }
                    },
                    layout: {
                        padding: {
                            top: 10,
                            bottom: 10
                        }
                    },
                    animation: {
                        animateRotate: true,
                        animateScale: true
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        function plotCharts(chartData) {
            console.log("Plotting charts with data:", chartData);
            if (chartData) {
                console.log(Array.isArray(chartData.days_used)); // Should log true
                console.log(Array.isArray(chartData.eligible_days)); // Should log true
                console.log(Array.isArray(chartData.leave_counts)); // Should log true

                plotChart(chartData);
                plotMonthlyChart(chartData);
                plotPieChart(chartData);
            } else {
                console.error("No chart data available");
            }
        }

        function fectch_data() {
            const employeeID = document.getElementById('Received_by').value;
            fetch(`/fetch_employee_leaves_data?employeeID=${employeeID}`)
                .then(response => response.json())
                .then(data => {
                    console.log("Received data:", data);

                    // Populate the first table with leave type summary data
                    const leaveTableBody = document.getElementById('leaveTableBody');
                    leaveTableBody.innerHTML = ''; // Clear any existing rows

                    // Initialize totals
                    let totalEligibleDays = 0;
                    let totalDaysUsed = 0;
                    let totalDaysLeft = 0;

                    // Loop through each leave type and populate table rows
                    data.chart_data.leave_types.forEach((leaveType, index) => {
                        const eligibleDays = data.chart_data.eligible_days[index];
                        const daysUsed = data.chart_data.days_used[index];
                        const daysLeft = eligibleDays - daysUsed;

                        // Calculate totals
                        totalEligibleDays += eligibleDays;
                        totalDaysUsed += daysUsed;
                        totalDaysLeft += daysLeft;

                        // Create a new row for each leave type
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${leaveType}</td>
                            <td>${eligibleDays}</td>
                            <td>${daysUsed}</td>
                            <td>${daysLeft.toFixed(2)}</td>
                        `;
                        leaveTableBody.appendChild(row);
                    });

                    // Add a final row for the totals
                    const totalRow = document.createElement('tr');
                    totalRow.style.backgroundColor = '#f5f5f5';
                    totalRow.style.fontWeight = 'bold';
                    totalRow.innerHTML = `
                        <td>Total</td>
                        <td>${totalEligibleDays.toFixed(2)}</td>
                        <td>${totalDaysUsed.toFixed(2)}</td>
                        <td>${totalDaysLeft.toFixed(2)}</td>
                    `;
                    leaveTableBody.appendChild(totalRow);

                    // Populate the second table with approved_leaves_data
                    const approvedTableBody = document.getElementById('approvedLeaveTableBody');
                    approvedTableBody.innerHTML = ''; // Clear any existing rows

                    data.approved_leaves_data.forEach(leave => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${leave.leave_type}</td>
                            <td>${leave.start_date}</td>
                            <td>${leave.end_date}</td>
                            <td>${leave.number_of_days}</td>
                            <td>${leave.status}</td>
                            <td>${leave.approved_by}</td>
                        `;
                        approvedTableBody.appendChild(row);
                    });

                    // Plot all charts using the consolidated plotCharts function
                    plotCharts(data.chart_data);
                })
                .catch(error => console.error('Error fetching leaves:', error));
        }

    </script>

    <style>
        /* leave*/

        /* Style for the table */
        .content-table {
            width: 100%;
            border-collapse: collapse;
            /* Ensure borders are combined */
        }

        /* Style for the table head */
        .content-table-leave thead th {
            position: sticky;
            top: 0;
            background-color: whitesmoke;
            /* Background color of the header */
            color: black;
            /* Text color of the header */
            text-align: left;
            font-weight: bold;
            z-index: 1;
            /* Ensure the header is above the table rows */
            border-bottom: 2px solid;
            /* Border to separate header from table body */
        }

        /* Style for table cells */
        .content-table-leave th,
        .content-table-leave td {
            padding: 6px 7px;
        }

        /* Style for table rows */
        .content-table-leave tbody tr {
            border-bottom: 1px solid white;
        }

        .content-table-leave tbody tr:nth-of-type(even) {
            background-color: whitesmoke;
        }

        .content-table-leave tbody tr:last-of-type {
            border-bottom: 2px solid black;
        }

        .content-table-leave tbody tr.active-row {
            font-weight: bold;
            color: black;
        }


        .content-table-leave thead th:nth-child(2),
        .content-table-leave tbody td:nth-child(2),
        .content-table-leave thead th:nth-child(0),
        .content-table-leave tbody td:nth-child(0),


        .content-table-leave thead th:nth-child(9),
        .content-table-leave tbody td:nth-child(9),
        .content-table-leave thead th:nth-child(3),
        .content-table-leave tbody td:nth-child(3),
        .content-table-leave thead th:nth-child(4),
        .content-table-leave tbody td:nth-child(4),
        .content-table-leave thead th:nth-child(5),
        .content-table-leave tbody td:nth-child(5),
        .content-table-leave thead th:nth-child(6),
        .content-table-leave tbody td:nth-child(6),
        .content-table-leave thead th:nth-child(8),
        .content-table-leave tbody td:nth-child(8),
        .content-table-leave thead th:nth-child(7),
        .content-table-leave tbody td:nth-child(7) {
            text-align: center;
        }

        .content-table-leave .fa-trash,
        .fa-edit {
            font-size: 1.2em;
        }



        .table-responsive2 {
            width: 100%;
            overflow: auto;
            min-height: 270px;
            max-height: 270px;
        }

        /* Main container to set up the two columns */
        .mainbox {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
        }

        /* Column boxes */
        .column {
            flex: 1;
            /* Each column takes equal width */
            min-width: 300px;
            /* Minimum width for responsiveness */
            /* box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); */
            border-radius: 8px;
            padding: 20px;
            box-sizing: border-box;
        }

        .first-column {

            gap: 20px;

        }

        /* Second column with two rows */
        .second-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Each row in the second column */
        .row {
            /* background-color: #f5f5f5; */
            padding: 20px;
            border-radius: 8px;
        }



        .row label {
            flex: 1;
            /* Allow labels to expand and fill available space */
        }

        .row {
            display: flex;
            flex-wrap: wrap;
        }

        .col-6 {
            flex: 0 0 50%;
            padding: 5px;
        }

        /* Media query for mobile */
        @media (max-width: 768px) {
            .mainbox {
                flex-direction: column;
            }
        }
    </style>

    <style>
        .main-cards {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 20px;
            margin: 10px 0;
        }

        .card1 {
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            padding: 25px;
            background-color: #ffffff;
            box-sizing: border-box;
            border: 1px solid #d2d2d3;
            border-radius: 5px;
            box-shadow: 0 6px 7px -4px rgba(0, 0, 0, 0.2);
        }

        .card1-projects {
            border-left: 7px solid #246dec;
        }

        .card1-enquiries {
            border-left: 7px solid #f5b74f;
        }

        .card1-Claims {
            border-left: 7px solid #367952;
        }

        .card1-option {
            border-left: 7px solid #cc3c43;
        }

        .card1>span {
            font-size: 20px;
            font-weight: 600;
        }

        .card1-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .card1-inner>p {
            font-size: 18px;
        }

        .card1-inner>span {
            font-size: 35px;
        }

        .charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .charts-card {
            background-color: #ffffff;
            margin-bottom: 20px;
            padding: 25px;
            box-sizing: border-box;
            -webkit-column-break-inside: avoid;
            border: 1px solid #d2d2d3;
            border-radius: 5px;
            box-shadow: 0 6px 7px -4px rgba(0, 0, 0, 0.2);
        }

        .chart-title {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: 600;
        }
    </style>

    <style>
        .sub-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .sub {
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }

        .sub1 {
            grid-column: 1 / span 1;
            /* This takes 1 of 3 columns */
        }

        .sub2 {
            grid-column: 2 / span 1;
            /* This takes 1 of 3 columns */
        }

        .sub3 {
            grid-column: 3 / span 1;
            /* This takes 1 of 3 columns */
        }

        .sub4 {
            grid-column: 4 / span 1;
            /* This takes 1 of 3 columns */
        }

        .sub5 {
            grid-column: 2 / span 1;
        }

        .sub6 {
            grid-column: 3 / span 1;
        }

        .sub7 {
            grid-column: 1 / span 1;
        }


        .form-control {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
        }

        .form-select {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
        }

        .btn {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 14px;
            border-radius: 10px;
            margin-left: 10px;
        }

        .scrollable-tbody1 {
            display: block;
            max-height: 305px;
            max-width: 2000px;
            overflow: auto;
        }

        .form-row:last-child {
            margin-bottom: 0;
        }

        .table thead tr {
            position: sticky;
            top: 0;
            background-color: #BCC6CC;
        }

        .table {
            font-size: 16px;
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .table thead tr {
            position: sticky;
            top: 0;
            background-color: #004B5D;
            color: white;
            padding-right: 17px;
            margin-right: -17px;
        }

        .table-container table tbody tr {
            height: 40px;
        }

        .table-container table tbody td {
            height: 50px;
        }

        .table-container table thead tr {
            height: 40px;
        }

        .table-container table thead td {
            height: 40px;
        }

        .table-container table tbody tr:nth-child(odd) {
            background-color: #D8D8D8;
        }

        .table-container table tbody tr:nth-child(even) {
            background-color: #E8E8E8;
        }

        .table thead th:nth-child(1),
        .table tbody td:nth-child(1),
        .table thead th:nth-child(3),
        .table tbody td:nth-child(3),
        .table thead th:nth-child(4),
        .table tbody td:nth-child(4),
        .table thead th:nth-child(5),
        .table tbody td:nth-child(5),
        .table thead th:nth-child(6),
        .table tbody td:nth-child(6),

        .table thead th:nth-child(7),
        .table tbody td:nth-child(7),

        .table thead th:nth-child(8),
        .table tbody td:nth-child(8),
        .table thead th:nth-child(9),
        .table tbody td:nth-child(9),
        .table thead th:nth-child(10),
        .table tbody td:nth-child(10),

        .table thead th:nth-child(2),
        .table tbody td:nth-child(2) {
            text-align: center;
        }
    </style>

    <style>
        /* cards*/

        .cols {
            margin-top: 0px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .col {
            width: calc(12% - 1rem);
            /* Further reduced width */
            margin: 0.3rem;
            /* Reduced margin */
            cursor: pointer;
        }

        .container1 {
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        .front,
        .back {
            background-size: cover;
            border-radius: 10px;
            box-shadow: 0 4px 8px 0 rgba(194, 118, 118, 0.25);
            background-position: center;
            backface-visibility: hidden;
            transition: transform .7s cubic-bezier(0.4, 0.2, 0.2, 1);
            text-align: center;
            min-height: 130px;
            /* Reduced height to fit more cards */
            box-shadow: 0 0 10px solid blue;
            font-size: 1rem;
            /* Reduced font size */
            height: auto;
            border-radius: 10px;
            color: #fff;
        }

        .back {
            background: linear-gradient(45deg, #cedce7 0%, #596a72 100%);
        }

        .front:after {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
            width: 100%;
            height: 100%;
            content: '';
            border-radius: 10px;
            display: block;
            opacity: .6;
            background-color: #5bb3c7;
            backface-visibility: hidden;
        }

        .container1:hover .front,
        .container1:hover .back {
            transition: transform .7s cubic-bezier(0.4, 0.2, 0.2, 1);
        }

        .back {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
        }

        .inner {
            transform: translateY(-50%) translateZ(60px) scale(0.94);
            top: 50%;
            position: absolute;
            left: 0;
            width: 100%;
            padding: 1rem;
            /* Reduced padding */
            box-sizing: border-box;
            outline: 1px solid transparent;
            perspective: inherit;
            z-index: 2;
        }

        .container1 .back {
            transform: rotateY(180deg);
            transform-style: preserve-3d;
        }

        .container1 .front {
            transform: rotateY(0deg);
            transform-style: preserve-3d;
        }

        .container1:hover .back {
            transform: rotateY(0deg);
            transform-style: preserve-3d;
        }

        .container1:hover .front {
            transform: rotateY(-180deg);
            transform-style: preserve-3d;
        }

        .front .inner p {
            font-size: 1.5rem;
            /* Reduced font size */
            margin-bottom: 1rem;
            /* Reduced margin */
            position: relative;
        }

        .front .inner p:after {
            content: '';
            width: 4rem;
            height: 2px;
            position: absolute;
            background: #C6D4DF;
            display: block;
            left: 0;
            right: 0;
            margin: 0 auto;
            bottom: -.75rem;
        }

        .front .inner span {
            color: rgba(255, 255, 255, 0.7);
            font-family: 'Montserrat';
            font-weight: 300;
        }
    </style>

    <script>
        let menuList = document.getElementById("menuList")
        menuList.style.maxHeight = "0px";

        function toggleMenu() {
            if (menuList.style.maxHeight == "0px") {
                menuList.style.maxHeight = "300px";
            }
            else {
                menuList.style.maxHeight = "0px";
            }
        }

    </script>

    <style>
        .records {
            width: 100%;
            overflow-x: auto;
        }

        .record-header {
            width: 100%;
            padding: 10px;
            /* background-color: #d8eaf3; */
        }

        .container {
            display: flex;
            flex-direction: row;
            width: 100%;
            background-color: #0dc438;
        }


        .double-container2 {
            width: 100%;
            /* Ensure the container occupies full width */
            box-sizing: border-box;
            /* Include padding and border in element's total width and height */
            overflow-x: auto;
            /* Allow horizontal scrolling if the table is too wide */
            padding: 15px;
            /* Add padding to the container */
            border: 1px solid #ddd;
            /* Optional: Add a border for visual separation */
        }

        .double-container {
            width: 100%;
            /* Ensure the container occupies full width */
            box-sizing: border-box;
            /* Include padding and border in element's total width and height */
            overflow-x: auto;
            /* Allow horizontal scrolling if the table is too wide */
            padding: 15px;
            /* Add padding to the container */
            border: 1px solid #ddd;
            /* Optional: Add a border for visual separation */
        }

        .container_hours {
            width: 45%;
            box-sizing: border-box;
        }

        .btn4 {
            padding: 10px 12px;
            /* Adjusted for better spacing */
            font-size: 16px;
            border-radius: 10px;
            background-color: rgb(0, 75, 93);
            color: whitesmoke;
            margin: 2px;
            cursor: pointer;
            display: inline-block;
            /* Ensure buttons align correctly */
            text-align: center;
            /* Center text inside the button */
            flex: 1;
            /* Allow buttons to grow and shrink to fit available space */
        }

        /* Hover state */
        .btn4:hover {
            background-color: #035153;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .btn4 {
                font-size: 14px;
                padding: 8px 12px;
                /* Adjusted padding for smaller screens */
            }
        }

        @media (max-width: 480px) {
            .btn4 {
                font-size: 12px;
                padding: 6px 10px;
                /* Further adjusted padding */
            }
        }




        input[type=text],
        input[type=date],
        input[type=number],
        select {
            width: 100%;
            padding: 10px 20px;
            margin: 2px 0;
            /* Reduce the top and bottom margin */
            display: block;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        input[type=submit] {
            width: 100%;
            background-color: #04AA6D;
            color: white;
            padding: 14px 20px;
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        input[type=submit]:hover {
            background-color: #45a049;
        }

        .content-table-container {
            max-height: 400px;
            /* Set your desired max height */
            overflow-y: auto;
            border-radius: 5px;
        }

        .content-table {
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 0.9em;
            border-radius: 5px 5px 0 0;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
            width: 100%;
        }

        .container {
            border-radius: 5px;
            background-color: #f1ecec;
            padding: 10px;
            display: flex;
            gap: 50px;
            width: 100%;
        }

        .content-table thead {
            position: sticky;
            top: 0;
            z-index: 1;
            /* Ensure the header stays above the table rows */
        }

        .content-table thead tr {
            background-color: #004B5D;
            color: #e0cdcd;
            text-align: left;
            font-weight: bold;
        }

        .content-table th,
        .content-table td {
            padding: 12px 15px;
        }

        .content-table tbody tr {
            border-bottom: 1px solid #dddddd;
        }

        .content-table tbody tr:nth-of-type(even) {
            background-color: #f3f3f3;
        }

        .content-table tbody tr:last-of-type {
            border-bottom: 2px solid #004B5D;
        }

        .content-table tbody tr.active-row {
            font-weight: bold;
            color: #004B5D;
        }

        h1 {
            text-align: center;
        }
    </style>

    <script>

        function toggleContainer(section) {
            // Your code to handle the container toggle logic
            // console.log("Toggling container for section:", section);

        }

        function showSection(sectionId) {
            // Hide all sections
            var sections = document.querySelectorAll('.Pay_slip, .dashboard, .Personal_Details, .Leaves, .Courses, .Assets');
            sections.forEach(function (section) {
                section.style.display = 'none';
            });

            // Show the selected section
            var selectedSection = document.getElementById(sectionId);
            if (selectedSection) {
                selectedSection.style.display = 'block';
            }
        }


        window.onload = function () {
            // Check visibility value from server-side
            var optionValue = '{{ optionValue }}'; // The value of 'show' from the backend
            if (optionValue === 'leave_time') {
                showSection('Leaves');
                document.getElementById('LeavesRadio').checked = true;
            } else if (optionValue === 'dashboard') {
                showSection('Personal_Details');
                document.getElementById('Personal_DetailsRadio').checked = true;
            }

        };

    </script>

    <style>
        /* flash messages */

        .alert-container {
            margin-top: 10px;
        }

        .alert {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>

    <script>
        // Data for the line chart
        const dates = {{ dates | safe }};
        const hours = {{ hours | safe }};

        // LINE CHART
        const lineChartOptions = {
            series: [{ data: hours }],
            chart: {
                type: 'line', // Change to 'line' for a line chart
                height: 350,
                toolbar: { show: false },
            },
            colors: ['blue'], // Match the color to the Chart.js line color
            stroke: {
                width: 3, // Set the line width (adjust this value as needed)
            },
            markers: {
                size: 2, // Size of the dots at each data point
                colors: ['white'], // Color of the dots
                strokeColor: 'black', // Border color of the dots
                strokeWidth: 2, // Border width of the dots
                shape: 'circle', // Shape of the markers (dot)
                hover: {
                    size: 8, // Size of the dots when hovered
                },
            },
            plotOptions: {
                line: {
                    curve: 'smooth', // Optional: Make the line smooth
                    dataLabels: {
                        enabled: false, // Enable data labels at each node
                        style: {
                            fontSize: '12px',
                            colors: ['#ff7f94'], // Color of the data labels
                        }
                    }
                }
            },
            dataLabels: {
                enabled: false, // Enable data labels for each point
                style: {
                    colors: ['red'] // Color of the data labels
                }
            },
            legend: {
                show: false,
            },
            title: {
                text: 'Working Hours Trends for the Last 30 Days',
                align: 'center',
                style: {
                    color: 'black',
                    fontWeight: 'bold',
                    fontSize: '14px'
                }
            },
            xaxis: {
                categories: dates,
                labels: {
                    style: {
                        colors: '#whitesmoke' // Match the color of the x-axis labels
                    }
                }
            },
            yaxis: {
                title: {
                    text: 'Hours Worked',
                    style: {
                        color: '#whitesmoke',
                        fontWeight: 'bold',
                        fontSize: '14px',
                    }
                },
                labels: {
                    style: {
                        colors: '#whitesmoke' // Match the color of the y-axis labels
                    }
                },
                min: 0 // Start y-axis from 0
            },
            tooltip: {
                y: {
                    formatter: function (value) {
                        return `Hours Worked: ${value}`; // Format the tooltip label
                    }
                }
            },
            responsive: [{
                breakpoint: 480,
                options: {
                    legend: {
                        position: 'bottom',
                        horizontalAlign: 'center'
                    }
                }
            }]
        };

        // Render the chart
        const lineChart = new ApexCharts(document.querySelector('#bar-chart'), lineChartOptions);
        lineChart.render();
    </script>

    <script>
        // Data for the doughnut chart
        const pro_ids = {{ pro_ids | safe }};
        const hours_spent = {{ hours_spent | safe }};

        // DOUGHNUT CHART
        const doughnutChartOptions = {
            series: hours_spent,
            chart: {
                type: 'donut',
                height: 340
            },
            colors: [
                '#ff6384',
                '#36a2eb',
                '#ffce56',
                '#4bc0c0',
                '#9966ff',
                '#ff9f40',
                '#f94144',
                '#f3722c',
                '#f8961e',
                '#f9c74f',
                '#90be6d',
                '#43aa8b',
                '#577590',
                '#5e60ce',
                '#8338ec',
                '#3a0ca3'

                // Add more colors if needed
            ],
            labels: pro_ids,
            plotOptions: {
                pie: {
                    donut: {
                        size: '70%', // Adjust the size of the donut hole
                    }
                }
            },
            dataLabels: {
                enabled: true,
                style: {
                    colors: ['white']
                }
            },
            legend: {
                show: true,
                labels: {
                    colors: '#black',
                    font: {
                        weight: 'bold'
                    }
                }
            },
            title: {
                text: 'Projects Worked On',
                align: 'center',
                style: {
                    color: 'black',
                    fontWeight: 'bold',
                    fontSize: '14px'
                }
            },
            responsive: [{
                breakpoint: 480,
                options: {
                    legend: {
                        position: 'bottom',
                        horizontalAlign: 'center'
                    }
                }
            }]
        };

        // Render the chart
        const doughnutChart = new ApexCharts(document.querySelector('#doughnut-chart'), doughnutChartOptions);
        doughnutChart.render();
    </script>

    <script>
        // Function to format a date string as 'day/month/year' with digits only
        function formatDate(dateString) {
            const date = new Date(dateString);
            if (isNaN(date.getTime())) {
                // Return an empty string for invalid dates
                return "";
            }

            const day = date.getDate().toString().padStart(2, "0");
            const month = (date.getMonth() + 1)
                .toString()
                .padStart(2, "0"); // Adding 1 because months are zero-based
            const year = date.getFullYear().toString().slice(-2);

            return `${day}/${month}/${year}`;
        }

        // Call the formatDate function for each date element when the page loads
        document.addEventListener("DOMContentLoaded", function () {
            const start_time_elements =
                document.querySelectorAll(".start-time");
            start_time_elements.forEach(function (element) {
                element.textContent = formatDate(element.textContent);
            });

        });
    </script>



</body>

</html>